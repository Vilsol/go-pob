var tn=Object.defineProperty;var Mt=t=>{throw TypeError(t)};var nn=(t,e,n)=>e in t?tn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var R=(t,e,n)=>nn(t,typeof e!="symbol"?e+"":e,n),nt=(t,e,n)=>e.has(t)||Mt("Cannot "+n);var ce=(t,e,n)=>(nt(t,e,"read from private field"),n?n.call(t):e.get(t)),Le=(t,e,n)=>e.has(t)?Mt("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),at=(t,e,n,r)=>(nt(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),Ct=(t,e,n)=>(nt(t,e,"access private method"),n);import{a as Te,t as Ze,c as an}from"../chunks/disclose-version.boCT8-mN.js";import{P as h,O as sn,al as rn,p as Qe,Q as K,am as on,g as a,R as U,U as cn,b as Dt,s as k,c as Wt,i as ut,r as ht,j as Ft,e as $e,an as ln,S as ie,T as Ee,$ as Ge,a as st,h as Z,I as fn,k as rt}from"../chunks/runtime.LiVz1aeE.js";import{b as dt,i as Yt}from"../chunks/this.BOTMusHW.js";import{i as wt}from"../chunks/lifecycle.B0c9Fntj.js";import{s as Bt,b as we}from"../chunks/store.Bh8AggrJ.js";import{p as Q,e as d,a as ne}from"../chunks/props.CgGGVFgu.js";import{s as un}from"../chunks/snippet.BIfwRIVK.js";import{s as Me}from"../chunks/attributes.BN4LPk7_.js";import{a as hn,b as dn,d as w,c as it}from"../chunks/misc.C8RtQfBL.js";import{s as yn}from"../chunks/class.n9mcWmlw.js";import{c as Ht,o as bt,a as Xt,d as mn}from"../chunks/index-client.wZdNs1fV.js";import{w as xt}from"../chunks/index.B8tINEtp.js";import{s as yt,l as Ue,c as gn}from"../chunks/global.DtJTI8bA.js";function ot(t,e,n,r,f){var y=t.__attributes??(t.__attributes={}),m=t.style,o="style-"+e;y[o]===n&&(!f||m.getPropertyValue(e)===n)||(y[o]=n,n==null?m.removeProperty(e):m.setProperty(e,n,""))}var ue,Se,Re,Ke,Gt;const Ve=class Ve{constructor(e){Le(this,Ke);Le(this,ue,new WeakMap);Le(this,Se);Le(this,Re);at(this,Re,e)}observe(e,n){var r=ce(this,ue).get(e)||new Set;return r.add(n),ce(this,ue).set(e,r),Ct(this,Ke,Gt).call(this).observe(e,ce(this,Re)),()=>{var f=ce(this,ue).get(e);f.delete(n),f.size===0&&(ce(this,ue).delete(e),ce(this,Se).unobserve(e))}}};ue=new WeakMap,Se=new WeakMap,Re=new WeakMap,Ke=new WeakSet,Gt=function(){return ce(this,Se)??at(this,Se,new ResizeObserver(e=>{for(var n of e){Ve.entries.set(n.target,n);for(var r of ce(this,ue).get(n.target)||[])r(n)}}))},R(Ve,"entries",new WeakMap);let mt=Ve;var vn=new mt({box:"border-box"});function Tt(t,e,n){var r=vn.observe(t,()=>n(t[e]));h(()=>(sn(()=>n(t[e])),r))}function pn(t,e,n,r,f){var y=()=>{r(n[t])};n.addEventListener(e,y),y(),(n===document.body||n===window||n===document)&&rn(()=>{n.removeEventListener(e,y)})}class wn{constructor(){R(this,"currentLayerId");R(this,"setups");R(this,"renderers");R(this,"dispatchers");R(this,"startTime");R(this,"needsRedraw");R(this,"context");R(this,"width");R(this,"height");R(this,"autoplay");R(this,"autoclear");R(this,"pixelRatio");R(this,"renderLoop");R(this,"layerObserver");R(this,"layerRef");R(this,"layerSequence");R(this,"activeLayerId");R(this,"activeLayerDispatcher");R(this,"renderingLayerIdChangeCallback");this.register=this.register.bind(this),this.unregister=this.unregister.bind(this),this.redraw=this.redraw.bind(this),this.currentLayerId=1,this.setups=new Map,this.renderers=new Map,this.dispatchers=new Map,this.startTime=Date.now(),this.needsRedraw=!0,this.activeLayerId=0,this.layerSequence=[]}redraw(){this.needsRedraw=!0}register({setup:e,render:n,dispatcher:r}){return e&&this.setups.set(this.currentLayerId,e),this.renderers.set(this.currentLayerId,n),this.dispatchers.set(this.currentLayerId,r),this.needsRedraw=!0,{redraw:this.redraw,unregister:()=>this.unregister(this.currentLayerId),layerId:this.currentLayerId++}}unregister(e){this.renderers.delete(e),this.dispatchers.delete(e),this.needsRedraw=!0}init(e,n){this.context=e,this.layerRef=n,this.observeLayerSequence(),this.startRenderLoop()}observeLayerSequence(){this.layerObserver=new MutationObserver(()=>this.getLayerSequence()),this.layerObserver.observe(this.layerRef,{childList:!0}),this.getLayerSequence()}getLayerSequence(){const e=[...this.layerRef.children];this.layerSequence=e.map(n=>+n.dataset.layerId),this.redraw()}startRenderLoop(){this.render(),this.renderLoop=requestAnimationFrame(()=>this.startRenderLoop())}render(){var o,g;const e=this.context,n=this.width,r=this.height,f=this.pixelRatio,y=Date.now()-this.startTime,m={context:e,width:n,height:r,time:y};for(const[b,L]of this.setups)L(m),this.setups.delete(b);if(this.needsRedraw){e.setTransform(f,0,0,f,0,0),this.autoclear&&e.clearRect(0,0,n,r);for(const b of this.layerSequence)(o=this.renderingLayerIdChangeCallback)==null||o.call(this,b),(g=this.renderers.get(b))==null||g(m);this.needsRedraw=this.autoplay}}setActiveLayer(e,n){var r,f,y,m;this.activeLayerId!==e&&(n instanceof MouseEvent&&((r=n.target)==null||r.dispatchEvent(new PointerEvent("layer.pointerleave",n)),(f=n.target)==null||f.dispatchEvent(new MouseEvent("layer.mouseleave",n))),this.activeLayerId=e,this.activeLayerDispatcher=this.dispatchers.get(e),n instanceof MouseEvent&&((y=n.target)==null||y.dispatchEvent(new PointerEvent("layer.pointerenter",n)),(m=n.target)==null||m.dispatchEvent(new MouseEvent("layer.mouseenter",n))))}dispatchLayerEvent(e){if(this.activeLayerDispatcher){if(window.TouchEvent&&e instanceof TouchEvent){const{left:n,top:r}=e.target.getBoundingClientRect(),{clientX:f,clientY:y}=e.changedTouches[0],m={x:f-n,y:y-r,originalEvent:e};this.activeLayerDispatcher(e.type,m)}else if(e instanceof MouseEvent){const n={x:e.offsetX,y:e.offsetY,originalEvent:e},r=e.type.replace("layer.","");this.activeLayerDispatcher(r,n)}}}onRenderingLayerIdChange(e){this.renderingLayerIdChangeCallback=e}destroy(){var e;typeof window>"u"||((e=this.layerObserver)==null||e.disconnect(),cancelAnimationFrame(this.renderLoop))}}const bn=t=>{const e=t*2,n=e>>16&255,r=e>>8&255,f=e&255;return[n,r,f]},xn=([t,e,n])=>{const r=(t<<16|e<<8|n)/2;return r%1?0:r},Sn=["filter","shadowBlur","globalCompositeOperation","globalAlpha","fillStyle","strokeStyle"],In=(t,e,{rgbToId:n=xn,idToRgb:r=bn}={})=>{const f=t.getContext("2d",e),y=new OffscreenCanvas(t.width,t.height),m=y.getContext("2d",{willReadFrequently:!0,alpha:(e==null?void 0:e.alpha)??!0});return new MutationObserver(()=>{y.width=t.width,y.height=t.height}).observe(t,{attributeFilter:["width","height"]}),new Proxy(f,{get(g,b){if(b==="getLayerIdAt")return(S,p)=>{const[x,A,F]=m.getImageData(S,p,1,1).data;return n([x,A,F])};if(b==="setCurrentLayerId")return S=>{const[p,x,A]=r(S),F=`rgb(${p},${x},${A})`;m.fillStyle=F,m.strokeStyle=F};const L=g[b];return typeof L!="function"?L:(...S)=>{let p=b,x=S;return b==="drawImage"&&(p="fillRect",x=S.slice(-4)),m[p](...x),Reflect.apply(L,g,S)}},set(g,b,L){return g[b]=L,Sn.includes(b)||(m[b]=L),!0}})};/*!
 * canvas-size
 * v1.2.6
 * https://github.com/jhildenbiddle/canvas-size
 * (c) 2015-2023 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */function kn(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,f,y,m,o=[],g=!0,b=!1;try{if(y=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;g=!1}else for(;!(g=(r=y.call(n)).done)&&(o.push(r.value),o.length!==e);g=!0);}catch(L){b=!0,f=L}finally{try{if(!g&&n.return!=null&&(m=n.return(),Object(m)!==m))return}finally{if(b)throw f}}return o}}function Rt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(f){return Object.getOwnPropertyDescriptor(t,f).enumerable})),n.push.apply(n,r)}return n}function V(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Rt(Object(n),!0).forEach(function(r){Pn(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Rt(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Pn(t,e,n){return e=_n(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ln(t,e){if(t==null)return{};var n={},r=Object.keys(t),f,y;for(y=0;y<r.length;y++)f=r[y],!(e.indexOf(f)>=0)&&(n[f]=t[f]);return n}function En(t,e){if(t==null)return{};var n=Ln(t,e),r,f;if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(t);for(f=0;f<y.length;f++)r=y[f],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function _t(t,e){return On(t)||kn(t,e)||Ut(t,e)||Tn()}function Ye(t){return An(t)||Mn(t)||Ut(t)||Cn()}function An(t){if(Array.isArray(t))return gt(t)}function On(t){if(Array.isArray(t))return t}function Mn(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Ut(t,e){if(t){if(typeof t=="string")return gt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gt(t,e)}}function gt(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Cn(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tn(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rn(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _n(t){var e=Rn(t,"string");return typeof e=="symbol"?e:String(e)}function Ce(t){var e=t.sizes.shift(),n=Math.max(Math.ceil(e[0]),1),r=Math.max(Math.ceil(e[1]),1),f=[n-1,r-1,1,1],y=Date.now(),m=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,o,g;m?(o=new OffscreenCanvas(1,1),g=new OffscreenCanvas(n,r)):(o=document.createElement("canvas"),o.width=1,o.height=1,g=document.createElement("canvas"),g.width=n,g.height=r);var b=o.getContext("2d"),L=g.getContext("2d");L&&(L.fillRect.apply(L,f),b.drawImage(g,n-1,r-1,1,1,0,0,1,1));var S=b&&b.getImageData(0,0,1,1).data[3]!==0,p=Date.now()-y;return[o,g].forEach(function(x){x.height=0,x.width=0}),m?(postMessage({width:n,height:r,benchmark:p,isTestPass:S}),!S&&t.sizes.length&&Ce(t)):S?t.onSuccess(n,r,p):(t.onError(n,r,p),t.sizes.length&&Ce(t)),S}var ct={area:[16384,14188,11402,11180,10836,8192,4096,1],height:[8388607,65535,32767,16384,8192,4096,1],width:[4194303,65535,32767,16384,8192,4096,1]},Nn=["onError","onSuccess"],be={max:null,min:1,sizes:[],step:1024,usePromise:!1,useWorker:!1,onError:Function.prototype,onSuccess:Function.prototype},Ae={};function lt(t){var e=t.width===t.height,n=t.height===1,r=t.width===1,f=[];if(!t.width||!t.height)t.sizes.forEach(function(L){var S=e||n?L:1,p=e||r?L:1;f.push([S,p])});else for(var y=t.min||be.min,m=t.step||be.step,o=Math.max(t.width,t.height);o>=y;){var g=e||n?o:1,b=e||r?o:1;f.push([g,b]),o-=m}return f}function Be(t){var e=window&&"HTMLCanvasElement"in window,n=window&&"OffscreenCanvas"in window,r=Date.now(),f=t.onError,y=t.onSuccess,m=En(t,Nn),o=null;if(!e)return!1;if(t.useWorker&&n){var g=`
            var canvasTest = `.concat(Ce.toString(),`;
            onmessage = function(e) {
                canvasTest(e.data);
            };
        `),b=new Blob([g],{type:"application/javascript"}),L=URL.createObjectURL(b);o=new Worker(L),URL.revokeObjectURL(L),o.onmessage=function(S){var p=S.data,x=p.width,A=p.height,F=p.benchmark,q=p.isTestPass;q?(Ae[r].onSuccess(x,A,F),delete Ae[r]):Ae[r].onError(x,A,F)}}if(t.usePromise)return new Promise(function(S,p){var x=V(V({},t),{},{onError:function(Y,z,B){var P;if(t.sizes.length===0)P=!0;else{var Ie=t.sizes.slice(-1),N=_t(Ie,1),$=_t(N[0],2),he=$[0],E=$[1];P=Y===he&&z===E}f(Y,z,B),P&&p({width:Y,height:z,benchmark:B})},onSuccess:function(Y,z,B){y(Y,z,B),S({width:Y,height:z,benchmark:B})}});if(o){var A=x.onError,F=x.onSuccess;Ae[r]={onError:A,onSuccess:F},o.postMessage(m)}else Ce(x)});if(o)Ae[r]={onError:f,onSuccess:y},o.postMessage(m);else return Ce(t)}var jn={maxArea:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=lt({width:e.max,height:e.max,min:e.min,step:e.step,sizes:Ye(ct.area)}),r=V(V(V({},be),e),{},{sizes:n});return Be(r)},maxHeight:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=lt({width:1,height:e.max,min:e.min,step:e.step,sizes:Ye(ct.height)}),r=V(V(V({},be),e),{},{sizes:n});return Be(r)},maxWidth:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=lt({width:e.max,height:1,min:e.min,step:e.step,sizes:Ye(ct.width)}),r=V(V(V({},be),e),{},{sizes:n});return Be(r)},test:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=V(V({},be),e);return n.sizes=Ye(n.sizes),n.width&&n.height&&(n.sizes=[[n.width,n.height]]),Be(n)}};const zn=(t,e,n,r=.1)=>{if(typeof window>"u")return n;for(;!jn.test({sizes:[[t*n,e*n]]});)n-=r;return n},qt=Symbol(),Dn=()=>ln(qt);var Wn=Ze("<canvas></canvas> <div><!></div>",1);function Fn(t,e){Qe(e,!1);const n=K(),r=K(),f=K(),y=K(),m=K(),o=K();let g=Q(e,"width",8,null),b=Q(e,"height",8,null),L=Q(e,"pixelRatio",8,null),S=Q(e,"style",8,""),p=Q(e,"autoplay",8,!1),x=Q(e,"autoclear",8,!0),A=Q(e,"layerEvents",8,!1),F=Q(e,"contextSettings",8,void 0),q=K(),Y=null,z=K(),B=K(),P=K(),Ie=Q(e,"class",8,""),N=K(),$=K();const he=Ht(),E=K(new wn);on(qt,a(E).register);function X(){a(E).redraw()}function _e(){return a(q)}function ke(){return Y}bt(()=>{A()?(Y=In(a(q),F()),a(E).onRenderingLayerIdChange(s=>{Y.setCurrentLayerId(s)})):Y=a(q).getContext("2d",F()),a(E).init(Y,a(z))}),Xt(()=>a(E).destroy());const Ne=s=>{const u=new ResizeObserver(([{contentRect:ae}])=>{k(N,ae.width),k($,ae.height)});return u.observe(s),{destroy:()=>u.disconnect()}},je=s=>{const u=s.offsetX*a(f),ae=s.offsetY*a(f),le=Y.getLayerIdAt(u,ae);a(E).setActiveLayer(le,s),a(E).dispatchLayerEvent(s)},ze=s=>{const{clientX:u,clientY:ae}=s.changedTouches[0],{left:le,top:We}=a(q).getBoundingClientRect(),pe=(u-le)*a(f),tt=(ae-We)*a(f),i=Y.getLayerIdAt(pe,tt);a(E).setActiveLayer(i,s),a(E).dispatchLayerEvent(s)},Pe=s=>{a(E).dispatchLayerEvent(s)};U(()=>(ie(g()),a(N)),()=>{k(n,g()??a(N)??0)}),U(()=>(ie(b()),a($)),()=>{k(r,b()??a($)??0)}),U(()=>(a(B),ie(L()),a(n),a(r)),()=>{a(B)&&L()==="auto"?k(P,zn(a(n),a(r),a(B))):k(P,void 0)}),U(()=>(a(P),ie(L()),a(B)),()=>{k(f,a(P)??L()??a(B)??2)}),U(()=>a(n),()=>{Ee(E,a(E).width=a(n))}),U(()=>a(r),()=>{Ee(E,a(E).height=a(r))}),U(()=>a(f),()=>{Ee(E,a(E).pixelRatio=a(f))}),U(()=>ie(p()),()=>{Ee(E,a(E).autoplay=p())}),U(()=>ie(x()),()=>{Ee(E,a(E).autoclear=x())}),U(()=>(a(n),a(r),a(f),ie(x()),a(E)),()=>{a(n),a(r),a(f),x(),a(E).redraw()}),U(()=>ie(A()),()=>{k(y,A()?je:null)}),U(()=>ie(A()),()=>{k(m,A()?ze:null)}),U(()=>ie(A()),()=>{k(o,A()?Pe:null)}),U(()=>(a(n),a(r),a(f)),()=>{he("resize",{width:a(n),height:a(r),pixelRatio:a(f)})}),cn(),wt();var De=Wn(),l=Dt(De);dt(l,s=>k(q,s),()=>a(q));var ve=Wt(l,2);dt(ve,s=>k(z,s),()=>a(z)),ot(ve,"display","none");var et=ut(ve);return hn(et,e,"default",{},null),ht(ve),Ft(()=>{yn(l,Ie()),Me(l,"width",a(n)*a(f)),Me(l,"height",a(r)*a(f)),Me(l,"style",S()),ot(l,"width",g()?`${g()}px`:"100%",void 0,!0),ot(l,"height",b()?`${b()}px`:"100%",void 0,!0)}),pn("devicePixelRatio","resize",Ge,s=>k(B,s)),dn(l,s=>Ne(s)),h(()=>Tt(l,"clientWidth",s=>k(N,s))),h(()=>Tt(l,"clientHeight",s=>k($,s))),h(()=>d("touchstart",l,function(...s){var u;(u=a(m))==null||u.apply(this,s)})),h(()=>d("mousemove",l,function(...s){var u;(u=a(y))==null||u.apply(this,s)})),h(()=>d("pointermove",l,function(...s){var u;(u=a(y))==null||u.apply(this,s)})),h(()=>d("click",l,function(...s){var u;(u=a(o))==null||u.apply(this,s)})),h(()=>d("contextmenu",l,function(...s){var u;(u=a(o))==null||u.apply(this,s)})),h(()=>d("dblclick",l,function(...s){var u;(u=a(o))==null||u.apply(this,s)})),h(()=>d("mousedown",l,function(...s){var u;(u=a(o))==null||u.apply(this,s)})),h(()=>d("mouseup",l,function(...s){var u;(u=a(o))==null||u.apply(this,s)})),h(()=>d("wheel",l,function(...s){var u;(u=a(o))==null||u.apply(this,s)})),h(()=>d("touchcancel",l,function(...s){var u;(u=a(o))==null||u.apply(this,s)})),h(()=>d("touchend",l,function(...s){var u;(u=a(o))==null||u.apply(this,s)})),h(()=>d("touchmove",l,function(...s){var u;(u=a(o))==null||u.apply(this,s)})),h(()=>d("pointerdown",l,function(...s){var u;(u=a(o))==null||u.apply(this,s)})),h(()=>d("pointerup",l,function(...s){var u;(u=a(o))==null||u.apply(this,s)})),h(()=>d("pointercancel",l,function(...s){var u;(u=a(o))==null||u.apply(this,s)})),h(()=>d("layer.mouseenter",l,function(...s){var u;(u=a(o))==null||u.apply(this,s)})),h(()=>d("layer.mouseleave",l,function(...s){var u;(u=a(o))==null||u.apply(this,s)})),h(()=>d("layer.pointerenter",l,function(...s){var u;(u=a(o))==null||u.apply(this,s)})),h(()=>d("layer.pointerleave",l,function(...s){var u;(u=a(o))==null||u.apply(this,s)})),h(()=>d("focus",l,function(s){w.call(this,e,s)})),h(()=>d("blur",l,function(s){w.call(this,e,s)})),h(()=>d("fullscreenchange",l,function(s){w.call(this,e,s)})),h(()=>d("fullscreenerror",l,function(s){w.call(this,e,s)})),h(()=>d("scroll",l,function(s){w.call(this,e,s)})),h(()=>d("cut",l,function(s){w.call(this,e,s)})),h(()=>d("copy",l,function(s){w.call(this,e,s)})),h(()=>d("paste",l,function(s){w.call(this,e,s)})),h(()=>d("keydown",l,function(s){w.call(this,e,s)})),h(()=>d("keypress",l,function(s){w.call(this,e,s)})),h(()=>d("keyup",l,function(s){w.call(this,e,s)})),h(()=>d("auxclick",l,function(s){w.call(this,e,s)})),h(()=>d("click",l,function(s){w.call(this,e,s)})),h(()=>d("contextmenu",l,function(s){w.call(this,e,s)})),h(()=>d("dblclick",l,function(s){w.call(this,e,s)})),h(()=>d("mousedown",l,function(s){w.call(this,e,s)})),h(()=>d("mouseenter",l,function(s){w.call(this,e,s)})),h(()=>d("mouseleave",l,function(s){w.call(this,e,s)})),h(()=>d("mousemove",l,function(s){w.call(this,e,s)})),h(()=>d("mouseover",l,function(s){w.call(this,e,s)})),h(()=>d("mouseout",l,function(s){w.call(this,e,s)})),h(()=>d("mouseup",l,function(s){w.call(this,e,s)})),h(()=>d("select",l,function(s){w.call(this,e,s)})),h(()=>d("wheel",l,function(s){w.call(this,e,s)})),h(()=>d("drag",l,function(s){w.call(this,e,s)})),h(()=>d("dragend",l,function(s){w.call(this,e,s)})),h(()=>d("dragenter",l,function(s){w.call(this,e,s)})),h(()=>d("dragstart",l,function(s){w.call(this,e,s)})),h(()=>d("dragleave",l,function(s){w.call(this,e,s)})),h(()=>d("dragover",l,function(s){w.call(this,e,s)})),h(()=>d("drop",l,function(s){w.call(this,e,s)})),h(()=>d("touchcancel",l,function(s){w.call(this,e,s)})),h(()=>d("touchend",l,function(s){w.call(this,e,s)})),h(()=>d("touchmove",l,function(s){w.call(this,e,s)})),h(()=>d("touchstart",l,function(s){w.call(this,e,s)})),h(()=>d("pointerover",l,function(s){w.call(this,e,s)})),h(()=>d("pointerenter",l,function(s){w.call(this,e,s)})),h(()=>d("pointerdown",l,function(s){w.call(this,e,s)})),h(()=>d("pointermove",l,function(s){w.call(this,e,s)})),h(()=>d("pointerup",l,function(s){w.call(this,e,s)})),h(()=>d("pointercancel",l,function(s){w.call(this,e,s)})),h(()=>d("pointerout",l,function(s){w.call(this,e,s)})),h(()=>d("pointerleave",l,function(s){w.call(this,e,s)})),h(()=>d("gotpointercapture",l,function(s){w.call(this,e,s)})),h(()=>d("lostpointercapture",l,function(s){w.call(this,e,s)})),Te(t,De),it(e,"redraw",X),it(e,"getCanvas",_e),it(e,"getContext",ke),$e({redraw:X,getCanvas:_e,getContext:ke})}var Yn=Ze("<div></div>");function Bn(t,e){Qe(e,!1);let n=Q(e,"setup",8,void 0),r=Q(e,"render",8,()=>{});const f=Ht(),y=Dn(),m={setup:n(),render:r(),dispatcher:f},{layerId:o,unregister:g,redraw:b}=y(m);mn(b),Xt(g),wt();var L=Yn();Me(L,"data-layer-id",o),Te(t,L),$e()}const St=xt(void 0),It=xt(void 0);let T;const xe={},me={},fe={},Jt=new Set,qe={},vt={},Oe={},Kt={},C={};let He=.3835;const Nt={Juggernaut:{x:-10400,y:5200},Berserker:{x:-10400,y:3700},Chieftain:{x:-10400,y:2200},Raider:{x:10200,y:5200},Deadeye:{x:10200,y:2200},Pathfinder:{x:10200,y:3700},Occultist:{x:-1500,y:-9850},Elementalist:{x:0,y:-9850},Necromancer:{x:1500,y:-9850},Slayer:{x:1500,y:9800},Gladiator:{x:-1500,y:9800},Champion:{x:0,y:9800},Inquisitor:{x:-10400,y:-2200},Hierophant:{x:-10400,y:-3700},Guardian:{x:-10400,y:-5200},Assassin:{x:10200,y:-5200},Trickster:{x:10200,y:-3700},Saboteur:{x:10200,y:-2200},Ascendant:{x:-7800,y:7200}},ge={},Hn=async t=>{var n,r,f,y;if(!yt)return;const e=await yt.GetTree(t);T=JSON.parse(e),console.log("Loaded skill tree",T),T.imageZoomLevels&&(He=T.imageZoomLevels[T.imageZoomLevels.length-1]),Object.keys(T.groups).forEach(m=>{var b;const o=T.groups[m],g=parseInt(m);xe[g]=o,(b=o.nodes)==null||b.forEach(L=>{const S=T.nodes[L];if(me[parseInt(L)]=S,S.classStartIndex!==void 0){qe[g]=S.classStartIndex;for(const p of[...S.out||[],...S.in||[]]){const x=T.nodes[p];x.skill&&x.ascendancyName===void 0&&(vt[S.classStartIndex]=[...vt[S.classStartIndex]||[],x.skill])}}S.ascendancyName!==void 0&&(fe[g]=S.ascendancyName),S.isAscendancyStart&&(Jt.add(g),S.ascendancyName&&(ge[S.ascendancyName]={x:Nt[S.ascendancyName].x-o.x,y:Nt[S.ascendancyName].y-o.y}))})});for(const m of["keystoneInactive","notableInactive","normalInactive","masteryInactive"]){const o=(n=T.sprites[m])==null?void 0:n[He];Object.keys((o==null?void 0:o.coords)||{}).forEach(g=>o&&(Oe[g]=o))}for(const m of["keystoneActive","notableActive","normalActive","masteryActiveSelected"]){const o=(r=T.sprites[m])==null?void 0:r[He];Object.keys(o.coords).forEach(g=>o&&(Kt[g]=o))}for(const m of["background","mastery","masteryConnected","ascendancyBackground","ascendancy","startNode","groupBackground","frame","jewel","line","jewelRadius"]){let o=(f=T.sprites[m])==null?void 0:f[He];o||(o=(y=T.sprites[m])==null?void 0:y[Object.keys(T.sprites[m])[0]]),Object.keys((o==null?void 0:o.coords)||{}).forEach(g=>o&&(C[g]=o))}St.set(T),It.set(t)},Je=(t,e,n,r,f)=>({x:(Math.abs(T.min_x)+t+n)/f,y:(Math.abs(T.min_y)+e+r)/f}),Xn=(t,e,n)=>{const r=Math.PI/180*n,f=Math.cos(r),y=Math.sin(r),m=f*(e.x-t.x)+y*(e.y-t.y)+t.x,o=f*(e.y-t.y)-y*(e.x-t.x)+t.y;return{x:m,y:o}},jt=[0,30,45,60,90,120,135,150,180,210,225,240,270,300,315,330],zt=[0,10,20,30,40,45,50,60,70,80,90,100,110,120,130,135,140,150,160,170,180,190,200,210,220,225,230,240,250,260,270,280,290,300,310,315,320,330,340,350],pt=(t,e)=>{var r;const n=(r=T.constants.skillsPerOrbit)==null?void 0:r[t];return n==16?jt[jt.length-e]||0:n==40?zt[zt.length-e]||0:360-360/(n||1)*e},Xe={},ft=(t,e,n,r)=>{var f,y;if(t.group===void 0||t.orbit===void 0||t.orbitIndex===void 0||t.skill===void 0||!T.groups||!T.constants.orbitRadii)return{x:0,y:0};if(!(t.skill in Xe)){const m=T.groups[t.group],o=(t.ascendancyName&&((f=ge[t.ascendancyName])==null?void 0:f.x)||0)+m.x,g=(t.ascendancyName&&((y=ge[t.ascendancyName])==null?void 0:y.y)||0)+m.y,b=pt(t.orbit,t.orbitIndex);Xe[t.skill]=Xn({x:o,y:g},{x:o,y:g-T.constants.orbitRadii[t.orbit]},b)}return Je(Xe[t.skill].x,Xe[t.skill].y,e,n,r)},Gn=(t,e)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));var Un=Ze("<div><!> <!></div>"),qn=Ze('<div class="w-full h-full max-w-full max-h-full overflow-hidden"><!></div>');function Jn(t,e){Qe(e,!0);const n=Bt(),r=()=>we(gn,"$currentBuild",n),f=()=>we(It,"$skillTreeVersion",n),y=()=>we(St,"$skillTree",n),m=()=>we(he,"$hoverPath",n);let o=Z(void 0);st(()=>{var i;(i=r())==null||i.Build.ClassName.then(D=>k(o,ne(D))).catch(Ue)});let g=Z(void 0);st(()=>{var i;(i=r())==null||i.Build.AscendClassName.then(D=>k(g,ne(D))).catch(Ue)});let b=Q(e,"clickNode",19,()=>console.log);const L="25px Roboto Flex",S="17px Roboto Flex";let p=Z(10),x=Z(0),A=Z(0);const F=2.6;let q=rt(()=>`https://go-pob-data.pages.dev/data/${(f()||"3_18").replace("_",".")}`),Y=rt(()=>a(q)+"/tree/assets/");const z={},B={},P=(i,D,se,oe,G=!1,ee=!1,Fe=!1)=>{const j=oe[D];if(!j)return;const v=j.filename;if(!(v in z)){const _=new URL(v).pathname,re=_.substring(_.lastIndexOf("/")+1),J=a(Y)+re;z[v]=new Image,z[v].src=J}const c=j.coords[D],I=c.w/a(p)*F,O=c.h/a(p)*F,M=se.x-I/2,W=se.y-O/2;let H=W;if(G&&(H=W-O/2),ee&&z[v].complete){const _=v+":"+D+";"+(Fe?"active":"");if(!(_ in B)){const re=document.createElement("canvas"),J=re.getContext("2d");re.width=c.w,re.height=c.h,J.save(),J.beginPath(),J.arc(c.w/2,c.h/2,c.w/2,0,Math.PI*2,!0),J.closePath(),J.clip(),Fe||(J.filter="brightness(50%) opacity(50%)"),J.drawImage(z[v],c.x,c.y,c.w,c.h,0,0,c.w,c.h),B[_]=re}i.drawImage(B[_],0,0,c.w,c.h,M,H,I,O)}else i.drawImage(z[v],c.x,c.y,c.w,c.h,M,H,I,O);G&&(i.save(),i.translate(M,W),i.rotate(Math.PI),i.drawImage(z[v],c.x,c.y,c.w,c.h,-I,-(O/2),I,-O),i.restore())},Ie=(i,D,se)=>{const oe=[];let G="";return i.split(" ").forEach(ee=>{D.measureText(G+ee).width<se?G+=" "+ee:(oe.push(G.trim()),G=ee)}),G.length>0&&oe.push(G.trim()),oe};let N=Z(ne({x:Number.MIN_VALUE,y:Number.MIN_VALUE})),$=Z("unset");const he=xt([]),E=ne({});let X=Z(void 0),_e=rt(()=>({context:i,width:D,height:se})=>{const oe=window.performance.now();if(!y())return;if(i.clearRect(0,0,D,se),i.fillStyle="#080c11",i.fillRect(0,0,D,se),a(o)){const j=y().classes.findIndex(v=>v.name===a(o));if(j in y().extraImages){const v=y().extraImages[j];if(v.image in E||(E[v.image]=new Image,E[v.image].src=a(q)+"/raw/"+v.image),E[v.image].complete){const c=E[v.image].width/a(p)*F*.5,I=E[v.image].height/a(p)*F*.5,O=Je(v.x,v.y,a(x),a(A),a(p));i.drawImage(E[v.image],0,0,E[v.image].width,E[v.image].height,O.x,O.y,c,I)}}}const G={};Object.keys(xe).forEach(j=>{var H,_;const v=parseInt(j),c=xe[v],I=(v in fe&&((H=ge[fe[v]])==null?void 0:H.x)||0)+c.x,O=(v in fe&&((_=ge[fe[v]])==null?void 0:_.y)||0)+c.y,M=Je(I,O,a(x),a(A),a(p)),W=Math.max(...c.orbits);v in qe?a(o)===y().classes[qe[v]].name?P(i,"center"+y().classes[qe[v]].name.toLowerCase(),M,C):P(i,"PSStartNodeBackgroundInactive",M,C,!1,!0):v in fe?Jt.has(v)&&P(i,"Classes"+fe[v],M,C,!1,!0,a(g)===fe[v]):W==1?P(i,"PSGroupBackground1",M,C):W==2?P(i,"PSGroupBackground2",M,C):(W==3||c.orbits.length>1)&&P(i,"PSGroupBackground3",M,C,!0)}),Object.keys(me).forEach(j=>{var W;const v=parseInt(j),c=me[v],I=pt(c.orbit,c.orbitIndex),O=ft(c,a(x),a(A),a(p));if(c.classStartIndex!==void 0)return;const M=m().indexOf(c.skill)>=0;(W=c.out)==null||W.forEach(H=>{var Pt,Lt;if(!me[parseInt(H)])return;const _=Math.min(parseInt(H),parseInt(j)),re=Math.max(parseInt(H),parseInt(j)),J=_+":"+re;if(J in G)return;G[J]=!0;const te=me[parseInt(H)];if(te.isMastery||c.ascendancyName!==te.ascendancyName||te.classStartIndex!==void 0)return;const Vt=pt(te.orbit,te.orbitIndex),kt=ft(te,a(x),a(A),a(p));if(i.beginPath(),c.group!=te.group||c.orbit!=te.orbit)i.moveTo(O.x,O.y),i.lineTo(kt.x,kt.y);else{let de=Math.PI/180-Math.PI/180*I,ye=Math.PI/180-Math.PI/180*Vt;de-=Math.PI/2,ye-=Math.PI/2;const Et=Math.abs(Math.max(de,ye)-Math.min(de,ye)),Zt=Et>Math.PI?Math.max(de,ye):Math.min(de,ye),Qt=Et>Math.PI?Math.min(de,ye):Math.max(de,ye),At=xe[c.group],$t=(c.ascendancyName&&((Pt=ge[c.ascendancyName])==null?void 0:Pt.x)||0)+At.x,en=(c.ascendancyName&&((Lt=ge[c.ascendancyName])==null?void 0:Lt.y)||0)+At.y,Ot=Je($t,en,a(x),a(A),a(p));i.arc(Ot.x,Ot.y,y().constants.orbitRadii[c.orbit]/a(p)+1,Zt,Qt)}M&&m().indexOf(te.skill)>=0?i.strokeStyle="#c89c01":i.strokeStyle="#524518",i.lineWidth=6/a(p),i.stroke()})});let ee;if(Object.keys(me).forEach(j=>{const v=parseInt(j),c=me[v],I=ft(c,a(x),a(A),a(p));let O=0;c.classStartIndex!==void 0||c.isAscendancyStart||(c.isKeystone?O=110:c.isNotable||c.isJewelSocket?O=70:c.isMastery?O=85:O=50),Gn(I,a(N))<O/a(p)&&(ee=c);const M=m().indexOf(c.skill)>=0||ee===c;c.classStartIndex!==void 0||(c.isAscendancyStart?P(i,"AscendancyMiddle",I,C):c.isKeystone?(P(i,c.icon,I,Oe),M?P(i,"KeystoneFrameAllocated",I,C):P(i,"KeystoneFrameUnallocated",I,C)):c.isNotable?(P(i,c.icon,I,Oe),c.ascendancyName?M?P(i,"AscendancyFrameLargeAllocated",I,C):P(i,"AscendancyFrameLargeNormal",I,C):M?P(i,"NotableFrameAllocated",I,C):P(i,"NotableFrameUnallocated",I,C)):c.isJewelSocket?c.expansionJewel?M?P(i,"JewelSocketAltActive",I,C):P(i,"JewelSocketAltNormal",I,C):M?P(i,"JewelFrameAllocated",I,C):P(i,"JewelFrameUnallocated",I,C):c.isMastery?M?P(i,c.activeIcon,I,Kt):P(i,c.inactiveIcon,I,Oe):(P(i,c.icon,I,Oe),c.ascendancyName?M?P(i,"AscendancyFrameSmallAllocated",I,C):P(i,"AscendancyFrameSmallNormal",I,C):M?P(i,"PSSkillFrameActive",I,C):P(i,"PSSkillFrame",I,C)))}),a(X)!=ee)if(k(X,ne(ee)),a(X)!==void 0&&a(o)){const j=vt[y().classes.findIndex(c=>c.name===a(o))],v=a(X).skill;yt.CalculateTreePath(f()||"3_18",j,v).then(c=>{c&&he.set(c)}).catch(Ue)}else he.set([]);if(a(X)){const j=a(X).name||"N/A",v=(a(X).stats||[]).map(_=>({text:_,special:!1}));i.font=L;const c=i.measureText(j),I=Math.max(c.width+50,600);i.font=S;const O=[],M=30;let W=85;v&&v.length>0?v.forEach(_=>{O.length>0&&(W+=5),_.text.split(`
`).forEach(re=>{O.length>0&&(W+=10),Ie(re,i,I-M).forEach(te=>{O.push({text:te,offset:W,special:_.special}),W+=20})})}):a(X).isJewelSocket&&(O.push({text:"Click to select this socket",offset:W,special:!0}),W+=20);const H=55;i.fillStyle="rgba(75,63,24,0.9)",i.fillRect(a(N).x,a(N).y,I,H),i.fillStyle="#ffffff",i.font=L,i.textAlign="center",i.fillText(j,a(N).x+I/2,a(N).y+35),i.fillStyle="rgba(0,0,0,0.8)",i.fillRect(a(N).x,a(N).y+H,I,W-H),i.font=S,i.textAlign="left",O.forEach(_=>{_.special?i.fillStyle="#8cf34c":i.fillStyle="#ffffff",i.fillText(_.text,a(N).x+M/2,a(N).y+_.offset)})}a(X)?k($,"pointer"):k($,"unset"),i.fillStyle="#ffffff",i.textAlign="right",i.font="12px Roboto Mono";const Fe=window.performance.now();i.fillText(`${(Fe-oe).toFixed(1)}ms`,D-5,17)}),ke=0,Ne=0,je=0,ze=0,Pe=!1;const De=i=>{Pe=!0,ke=i.offsetX,Ne=i.offsetY,je=a(x),ze=a(A),k(N,ne({x:i.offsetX,y:i.offsetY})),a(X)&&b()(a(X))},l=i=>{i.type==="pointerup"&&(Pe=!1),k(N,ne({x:i.offsetX,y:i.offsetY}))},ve=i=>{Pe&&(k(x,je-(ke-i.offsetX)*a(p)),k(A,ze-(Ne-i.offsetY)*a(p))),k(N,ne({x:i.offsetX,y:i.offsetY}))},et=i=>{i.deltaY>0?a(p)<30&&(k(x,a(x)+i.offsetX),k(A,a(A)+i.offsetY)):a(p)>3&&(k(x,a(x)-i.offsetX),k(A,a(A)-i.offsetY)),k(p,ne(Math.min(30,Math.max(3,a(p)+i.deltaY/100)))),i.preventDefault(),i.stopPropagation(),i.stopImmediatePropagation()};let s=Z(void 0),u=Z(0),ae=Z(0);const le=()=>{a(s)&&(k(u,ne(a(s).offsetWidth)),k(ae,ne(a(s).offsetHeight)))};let We=Z(!1);st(()=>{!a(We)&&y()&&(k(We,!0),k(x,y().min_x+window.innerWidth/2*a(p)),k(A,y().min_y+window.innerHeight/2*a(p))),le()}),bt(()=>{new ResizeObserver(le).observe(a(s)),le()});var pe=qn();d("pointerup",Ge,l),d("pointermove",Ge,ve),d("resize",Ge,le),dt(pe,i=>k(s,i),()=>a(s));var tt=ut(pe);Yt(tt,()=>a(u)&&a(ae),i=>{var D=Un(),se=ut(D);Fn(se,{get width(){return a(u)},get height(){return a(ae)},$$events:{pointerdown:De,wheel:et},children:(G,ee)=>{Bn(G,{get render(){return a(_e)}})},$$slots:{default:!0}});var oe=Wt(se,2);un(oe,()=>e.children??fn),ht(D),Ft(()=>Me(D,"style",`touch-action: none; cursor: ${a($)??""}`)),Te(i,D)}),ht(pe),Te(t,pe),$e()}function la(t,e){Qe(e,!1);const n=Bt(),r=()=>we(St,"$skillTree",n),f=()=>we(It,"$skillTreeVersion",n);bt(()=>{(!r()||!f()||Object.keys(xe).length===0)&&Hn("3_18").catch(Ue)}),wt();var y=an(),m=Dt(y);Yt(m,()=>r()&&f()&&Object.keys(xe).length>0,o=>{Jn(o,{})}),Te(t,y),$e()}export{la as component};
